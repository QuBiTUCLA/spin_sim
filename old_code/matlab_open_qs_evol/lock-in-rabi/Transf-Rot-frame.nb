(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     12214,        321]
NotebookOptionsPosition[     11595,        296]
NotebookOutlinePosition[     11933,        311]
CellTagsIndexPosition[     11890,        308]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "script", " ", "should", " ", "calculate", " ", "the", " ", 
     "Effective", " ", "Hamiltonian", " ", "in", " ", "the", " ", "rotating", 
     " ", "frame"}], ",", " ", 
    RowBox[{
    "given", " ", "a", " ", "Hamiltonian", " ", "in", " ", "the", " ", "lab", 
     " ", "frame", " ", "H0"}], ",", " ", 
    RowBox[{
    "U", " ", "the", " ", "matrix", " ", "of", " ", "the", " ", 
     "transformation", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"see", " ", "Hoberst", " ", "diploma", " ", "thesis"}], ",", 
       " ", 
       RowBox[{
        RowBox[{"p", ".", " ", "18"}], " ", "plus", " ", "appendix"}]}], 
      ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"H0", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Delta]\[Omega]", ",", " ", 
        RowBox[{"Rabi", "*", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"w", "*", "t"}], " ", "+", " ", 
           RowBox[{"f", "[", "t", "]"}]}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Rabi", "*", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"w", "*", "t"}], " ", "+", " ", 
           RowBox[{"f", "[", "t", "]"}]}], "]"}]}], ",", " ", 
        RowBox[{"endel", " ", "-", "\[Delta]\[Omega]"}]}], "}"}]}], "}"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.512986688132157*^9, 3.512986796985001*^9}, {
   3.512986940028991*^9, 3.512986951794186*^9}, {3.512987002134718*^9, 
   3.512987041053382*^9}, {3.512987117298839*^9, 3.512987165657581*^9}, 
   3.512988501739417*^9, {3.512988844518224*^9, 3.512988858450538*^9}, {
   3.51298916067488*^9, 3.512989194296414*^9}, {3.512992050611798*^9, 
   3.512992070206239*^9}, {3.512992106227363*^9, 3.512992116757662*^9}, {
   3.51299251882163*^9, 3.512992521122119*^9}, {3.512992551575073*^9, 
   3.512992554390083*^9}, {3.512992819030443*^9, 3.512992894386626*^9}, {
   3.516703618443871*^9, 3.51670362037559*^9}, {3.516703833942164*^9, 
   3.51670385184174*^9}, {3.517559124774574*^9, 3.517559149501111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"U", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", "*", 
         RowBox[{"(", 
          RowBox[{"w", "*", "t"}], ")"}]}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.512987336114812*^9, 3.512987371631216*^9}, {
   3.512988864531356*^9, 3.512988866436044*^9}, {3.512989093276664*^9, 
   3.512989113127344*^9}, {3.512992081037034*^9, 3.512992086480296*^9}, {
   3.512993207412406*^9, 3.512993221769612*^9}, 3.516703616094161*^9, {
   3.516787367549121*^9, 3.516787368069331*^9}, 3.51678748449968*^9, 
   3.51678756574642*^9, {3.516787666095828*^9, 3.516787743153902*^9}, {
   3.516788339767127*^9, 3.516788363775845*^9}, 3.516788394876983*^9, {
   3.516788670302294*^9, 3.516788671162461*^9}, 3.516789488419246*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Formula", " ", "found", " ", "in", " ", "appendix", " ", "Oberst"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Refine", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"U", ".", "H0", ".", 
       RowBox[{"ConjugateTranspose", "[", "U", "]"}]}], " ", "-", " ", 
      RowBox[{"I", "*", 
       RowBox[{"U", ".", 
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"D", "[", 
          RowBox[{"U", ",", "t"}], "]"}], "]"}]}]}]}], "]"}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{
      RowBox[{"eta", "\[Element]", "Reals"}], " ", "&&", " ", 
      RowBox[{"t", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
      RowBox[{"w", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
      RowBox[{"wrot", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "'"}], "[", "t", "]"}], " ", "\[Element]", "Reals"}], 
      " ", "&&", " ", 
      RowBox[{"Omega", "\[Element]", "Reals"}], " ", "&&", " ", 
      RowBox[{"endel", " ", "\[Element]", "Reals"}], " ", "&&", " ", 
      RowBox[{
       RowBox[{"f", "[", "t", "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
      
      RowBox[{
       RowBox[{
        RowBox[{"f", "'"}], "[", "t", "]"}], "\[Element]", "Reals"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.512987389493179*^9, 3.512987416075219*^9}, {
   3.512987490827708*^9, 3.512987493515012*^9}, {3.512987683273205*^9, 
   3.512987686517897*^9}, {3.512987898530929*^9, 3.512987920932859*^9}, {
   3.512988110904965*^9, 3.51298812668629*^9}, {3.512988182129661*^9, 
   3.512988204314881*^9}, {3.512988249217859*^9, 3.512988266597788*^9}, {
   3.512988420086138*^9, 3.512988484609234*^9}, {3.512988697500863*^9, 
   3.512988702352715*^9}, {3.51298888382666*^9, 3.512988929277179*^9}, {
   3.51298912945239*^9, 3.512989132326887*^9}, {3.512989459831886*^9, 
   3.512989530513426*^9}, {3.512989749762511*^9, 3.512989827883698*^9}, 
   3.512989869643497*^9, {3.512989908544668*^9, 3.512989908658367*^9}, {
   3.512990023324583*^9, 3.512990029127199*^9}, {3.512990145324741*^9, 
   3.512990174853353*^9}, {3.512990317749559*^9, 3.51299034378457*^9}, {
   3.512991679930324*^9, 3.512991701422496*^9}, {3.512991809698033*^9, 
   3.512991822998512*^9}, {3.512991887283779*^9, 3.512991898090083*^9}, {
   3.512992136786828*^9, 3.512992165760985*^9}, {3.51299299316054*^9, 
   3.512993033634478*^9}, {3.512993726821051*^9, 3.5129937647544*^9}, {
   3.512993984042234*^9, 3.512993984149577*^9}, {3.516788421695627*^9, 
   3.516788429693429*^9}, {3.516788475719119*^9, 3.516788479872113*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Delta]\[Omega]", ",", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "t", " ", "w"}]], " ", "Rabi", 
      " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"t", " ", "w"}], "+", 
        RowBox[{"f", "[", "t", "]"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "t", " ", "w"}]], " ", "Rabi", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"t", " ", "w"}], "+", 
        RowBox[{"f", "[", "t", "]"}]}], "]"}]}], ",", 
     RowBox[{"endel", "-", "w", "-", "\[Delta]\[Omega]"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.512989509241314*^9, 3.512989527514224*^9}, 
   3.512989771138202*^9, 3.512989830846651*^9, 3.512989871763306*^9, 
   3.512989911268383*^9, 3.512990031476912*^9, {3.512990147917437*^9, 
   3.51299017717864*^9}, {3.512990333647033*^9, 3.512990345656129*^9}, {
   3.512991684678848*^9, 3.512991703416279*^9}, 3.51299182527455*^9, 
   3.512991899647077*^9, {3.512992168170837*^9, 3.512992177938861*^9}, 
   3.512992531514845*^9, 3.5129925625806*^9, 3.512992928987566*^9, {
   3.512992996958123*^9, 3.512993034398571*^9}, {3.512993216937483*^9, 
   3.51299322881445*^9}, {3.512993731013712*^9, 3.512993767340372*^9}, 
   3.512993986198287*^9, 3.512994120019148*^9, 3.51670365391692*^9, 
   3.516703812495997*^9, 3.516703866584623*^9, 3.516787400164977*^9, 
   3.516787492138483*^9, 3.516787571144833*^9, {3.516787641780212*^9, 
   3.516787651718954*^9}, {3.516787702024095*^9, 3.516787747692712*^9}, 
   3.516788347250566*^9, {3.516788388081056*^9, 3.516788399268056*^9}, 
   3.516788431432752*^9, 3.516788482061075*^9, 3.51678867579922*^9, 
   3.516789493829812*^9, 3.517559158660954*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.512993142384888*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"H1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"mu", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w", "*", "t"}], "+", 
            RowBox[{"phi", "[", "t", "]"}]}], ")"}]}], "]"}]}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mu", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w", "*", "t"}], " ", "+", " ", 
            RowBox[{"phi", "[", "t", "]"}]}], ")"}]}], "]"}]}], ",", " ", 
       "endel"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.512993817186478*^9, 3.512993876801635*^9}, {
  3.512995311353458*^9, 3.512995311785063*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Un", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"w", "*", "t"}], " ", "+", 
           RowBox[{"phi", "[", "t", "]"}]}], ")"}]}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.512993887009357*^9, 3.512993899152574*^9}, {
  3.512994015270038*^9, 3.51299401548434*^9}, {3.512995278834885*^9, 
  3.512995279215318*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Refine", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Un", ".", "H1", ".", 
      RowBox[{"ConjugateTranspose", "[", "Un", "]"}]}], " ", "-", " ", 
     RowBox[{"I", "*", 
      RowBox[{"Un", ".", 
       RowBox[{"ConjugateTranspose", "[", 
        RowBox[{"D", "[", 
         RowBox[{"Un", ",", "t"}], "]"}], "]"}]}]}]}], "]"}], ",", " ", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"eta", "\[Element]", "Reals"}], " ", "&&", " ", 
     RowBox[{"t", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
     RowBox[{"w", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
     RowBox[{"wrot", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"phi", "'"}], "[", "t", "]"}], " ", "\[Element]", "Reals"}], 
     " ", "&&", " ", 
     RowBox[{"Omega", "\[Element]", "Reals"}], " ", "&&", " ", 
     RowBox[{"endel", " ", "\[Element]", "Reals"}], " ", "&&", " ", 
     RowBox[{
      RowBox[{"phi", "[", "t", "]"}], " ", "\[Element]", "Reals"}]}]}]}], " ",
   "]"}]], "Input",
 CellChangeTimes->{{3.512993923842303*^9, 3.512993961870775*^9}, {
   3.512994042871868*^9, 3.512994076146453*^9}, 3.512994185122238*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "mu"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"mu", ",", 
     RowBox[{"endel", "-", "w", "-", 
      RowBox[{
       SuperscriptBox["phi", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.512993915580235*^9, 3.512993964355609*^9}, {
   3.512994027682845*^9, 3.512994079295052*^9}, 3.512995286854506*^9, 
   3.512995318660332*^9, 3.516703654239754*^9}]
}, Open  ]]
},
WindowSize->{740, 730},
WindowMargins->{{416, Automatic}, {58, Automatic}},
FrontEndVersion->"8.0 for Linux x86 (32-bit) (November 14, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 2180, 50, 126, "Input"],
Cell[2740, 72, 930, 21, 30, "Input"],
Cell[CellGroupData[{
Cell[3695, 97, 2670, 53, 145, "Input"],
Cell[6368, 152, 1894, 40, 33, "Output"]
}, Open  ]],
Cell[8277, 195, 68, 1, 30, "Input"],
Cell[8348, 198, 874, 27, 50, "Input"],
Cell[9225, 227, 602, 18, 30, "Input"],
Cell[CellGroupData[{
Cell[9852, 249, 1219, 28, 107, "Input"],
Cell[11074, 279, 505, 14, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
